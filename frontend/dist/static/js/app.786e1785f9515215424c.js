webpackJsonp([1],{"49FQ":function(t,e){},"5/3R":function(t,e){},"7Efb":function(t,e){},DhLu:function(t,e){},FO3c:function(t,e){},HVVO:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s("7+uW"),a=s("mtWM"),n=s.n(a),i={name:"app",data:function(){return{errors:[]}},computed:{user:function(){return this.$store.getters.getUser}},methods:{login:function(t){var e=this,s=t.target;n.a.post("https://pizzeria-order-backend.herokuapp.com/login",{email:s.elements[0].value,password:s.elements[1].value},{withCredentials:!0}).then(function(t){var s=t.data.user;e.$store.commit("setUser",{user:s})}).catch(function(t){e.errors.push(t)})},logout:function(t){this.$store.commit("clearSession")}}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("nav",{staticClass:"navbar navbar-expand-md navbar-dark bg-dark"},[s("router-link",{staticClass:"navbar-brand",attrs:{to:"/"}},[t._v("\n      Pizzabeställning.nu\n    ")]),t._v(" "),s("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarsExampleDefault"}},[s("ul",{staticClass:"navbar-nav mr-auto"},[s("router-link",{staticClass:"nav-item",attrs:{to:"/",tag:"li","active-class":"active",exact:""}},[s("a",{staticClass:"nav-link"},[t._v("Hem")])]),t._v(" "),s("router-link",{staticClass:"nav-item",attrs:{to:"/pizzerias",tag:"li","active-class":"active"}},[s("a",{staticClass:"nav-link"},[t._v("Pizzerior")])])],1),t._v(" "),Object.keys(t.user).length>=2?s("ul",{staticClass:"navbar-nav"},[s("router-link",{staticClass:"nav-item",attrs:{to:"/profile",tag:"li","active-class":"active",exact:""}},[s("a",{staticClass:"nav-link"},[t._v("\n            "+t._s(t.user.name)+"\n          ")])])],1):t._e(),t._v(" "),Object.keys(t.user).length<2?s("div",[s("form",{staticClass:"form-inline my-2 my-lg-0",on:{submit:function(e){e.preventDefault(),t.login(e)}}},[s("input",{staticClass:"form-control mr-sm-2",attrs:{type:"text",placeholder:"Användarnamn"}}),t._v(" "),s("input",{staticClass:"form-control mr-sm-2",attrs:{type:"password",placeholder:"Lösenord"}}),t._v(" "),s("button",{staticClass:"btn btn-outline-success my-sm-0",attrs:{type:"submit"}},[t._v("Logga in")]),t._v("\n           \n          "),s("router-link",{staticClass:"btn btn-outline-success",attrs:{to:"/register",tag:"button"}},[t._v("\n            Skapa konto\n          ")])],1)]):s("div",[s("button",{staticClass:"btn btn-outline-success",on:{click:t.logout}},[t._v("\n          Logga ut\n        ")])])])],1),t._v(" "),s("router-view")],1)},staticRenderFns:[]};var c=s("VU/8")(i,o,!1,function(t){s("iu0H")},null,null).exports,l=s("/ocq"),u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("main",[e("div",{staticClass:"jumbotron"},[e("div",{staticClass:"container"},[e("h1",{staticClass:"display-3"},[this._v("Välkommen till Pizzeriabeställning.nu")]),this._v(" "),e("p",[this._v("Här kan du söka efter dina lokala pizzerior och beställa pizza som levereras hela vägen hem till din dörr!")]),this._v(" "),e("p",[e("router-link",{staticClass:"btn btn-primary btn-lg",attrs:{to:"/pizzerias"}},[this._v("Visa pizzerior »")])],1)])])])},staticRenderFns:[]};var d=s("VU/8")({name:"Index",data:function(){return{}}},u,!1,function(t){s("Xm67")},"data-v-5f5c8122",null).exports,m={name:"Login",data:function(){return{errors:[]}},methods:{login:function(t){var e=this,s=t.target;n.a.post("https://pizzeria-order-backend.herokuapp.com/login",{email:s.elements[0].value,password:s.elements[1].value},{withCredentials:!0}).then(function(t){var s=t.data.user;e.$store.commit("setUser",{user:s}),e.$route.query.pizzeria?e.$router.push({name:"Pizzeria",params:{id:e.$route.query.pizzeria}}):e.$router.push("/pizzerias")}).catch(function(t){e.errors.push(t)})}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",[s("div",{staticClass:"container"},[s("h2",[t._v("Logga in")]),t._v(" "),s("form",{on:{submit:function(e){e.preventDefault(),t.login(e)}}},[t._m(0),t._v(" "),t._m(1),t._v(" "),s("button",{staticClass:"btn btn-primary mb-2",attrs:{type:"submit"}},[t._v("Logga in")]),t._v(" "),s("p",{staticClass:"text-danger"})]),t._v(" "),s("router-link",{staticClass:"btn btn-outline-success",attrs:{to:"/register",tag:"button"}},[t._v("\n      Skapa konto\n    ")])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"email"}},[this._v("E-post")]),this._v(" "),e("div",{staticClass:"col-sm-10"},[e("input",{staticClass:"form-control",attrs:{type:"email",id:"email",placeholder:"goran@system.se",required:""}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"password"}},[this._v("Lösenord")]),this._v(" "),e("div",{staticClass:"col-sm-10"},[e("input",{staticClass:"form-control",attrs:{type:"password",id:"password",placeholder:"•••••••••",required:""}})])])}]};var v=s("VU/8")(m,p,!1,function(t){s("Qajw")},"data-v-c5ff3c6e",null).exports,h=function(t){return t.replace(/.+?[.?!](\s|$)/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},f={name:"Register",data:function(){return{errors:[]}},methods:{signup:function(t){var e=this,s=t.target;n.a.post("https://pizzeria-order-backend.herokuapp.com/users",{user:{email:s.elements[0].value,password:s.elements[1].value,password_confirmation:s.elements[2].value,name:s.elements[3].value,address:s.elements[4].value}},{withCredentials:!0}).then(function(t){document.getElementsByClassName("text-danger")[0].innerHTML="";var s=t.data.user;e.$store.commit("setUser",{user:s}),e.$router.push("/")}).catch(function(t){if(t.response){var s="";for(var r in t.response.data.error)s=s+r+" "+t.response.data.error[r]+". ";document.getElementsByClassName("text-danger")[0].innerHTML=h(s)}e.errors.push(t)})}}},_={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",[s("div",{staticClass:"container"},[s("h2",[t._v("Registrera ett konto")]),t._v(" "),s("form",{on:{submit:function(e){e.preventDefault(),t.signup(e)}}},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),s("div",{staticClass:"col-auto"}),t._v(" "),s("button",{staticClass:"btn btn-primary mb-2",attrs:{type:"submit"}},[t._v("Registrera")]),t._v(" "),s("p",{staticClass:"text-danger"})])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"email"}},[this._v("E-post")]),this._v(" "),e("div",{staticClass:"col-sm-10"},[e("input",{staticClass:"form-control",attrs:{type:"email",id:"email",placeholder:"goran@system.se",required:""}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"password"}},[this._v("Lösenord")]),this._v(" "),e("div",{staticClass:"col-sm-10"},[e("input",{staticClass:"form-control",attrs:{type:"password",id:"password",placeholder:"•••••••••",required:""}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"password-confirmation"}},[this._v("Lösenordskonfirmation")]),this._v(" "),e("div",{staticClass:"col-sm-10"},[e("input",{staticClass:"form-control",attrs:{type:"password",id:"password-confirmation",placeholder:"•••••••••",required:""}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"name"}},[this._v("Namn")]),this._v(" "),e("div",{staticClass:"col-sm-10"},[e("input",{staticClass:"form-control",attrs:{type:"text",id:"name",placeholder:"Göran Johansson",required:""}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"address"}},[this._v("Adress")]),this._v(" "),e("div",{staticClass:"col-sm-10"},[e("input",{staticClass:"form-control",attrs:{type:"text",id:"address",placeholder:"Gata 1, 123 44, Vivalla",required:""}})])])}]};var g=s("VU/8")(f,_,!1,function(t){s("uc+P")},"data-v-12f5cdaa",null).exports,C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row"},[e("router-link",{attrs:{to:{name:"Pizzeria",params:{id:this.pizzeria.id}}}},[this._v("\n    "+this._s(this.pizzeria.name)+"\n  ")]),this._v(" "),e("hr")],1)},staticRenderFns:[]};var b={name:"PizzeriaList",components:{PizzeriaLink:s("VU/8")({name:"PizzeriaLink",props:["pizzeria"],data:function(){return{errors:[]}}},C,!1,function(t){s("HVVO")},"data-v-8b410858",null).exports},data:function(){return{pizzerias:[],pizzeriaCount:0,errors:[]}},created:function(){var t=this;n.a.get("https://pizzeria-order-backend.herokuapp.com/pizzeria").then(function(e){t.pizzerias=e.data,t.pizzeriaCount=t.pizzerias.length}).catch(function(e){t.errors.push(e)})}},z={render:function(){var t=this.$createElement,e=this._self._c||t;return e("main",[e("div",{staticClass:"container"},[e("hr"),this._v(" "),e("h1",[this._v("Pizzerior i databasen: "+this._s(this.pizzeriaCount))]),this._v(" "),this._l(this.pizzerias,function(t,s){return e("PizzeriaLink",{key:t.id,attrs:{index:s,pizzeria:t}})}),this._v(" "),e("hr")],2)])},staticRenderFns:[]};var w=s("VU/8")(b,z,!1,function(t){s("wdIp")},"data-v-44dc16e9",null).exports,k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{staticClass:"list-group-item d-flex justify-content-between align-items-center"},[s("span",[t._v("\n    "+t._s(t.item.counter)+". "+t._s(t.item.title)+"\n    "),s("small",[t._v(t._s(t.item.ingredients))])]),t._v(" "),s("span",[s("span",{staticClass:"badge badge-primary badge-pill"},[t._v(t._s(t.item.price)+"kr")]),t._v(" "),s("button",{staticClass:"btn btn-success btn-sm",on:{click:function(e){t.addToCart(t.item,e)}}},[t._v("Köp")])])])},staticRenderFns:[]};var $={name:"Menu",components:{MenuItem:s("VU/8")({name:"MenuItem",props:["item"],data:function(){return{errors:[]}},methods:{addToCart:function(t,e){this.$store.getters.getUser.name?this.$store.commit("addToCart",{item:t}):this.$router.push({path:"/login",query:{pizzeria:t.pizzeria_id}})}}},k,!1,function(t){s("7Efb")},"data-v-24b0186d",null).exports},props:["menu"],data:function(){return{errors:[]}}},y={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h2",[this._v(this._s(this.menu[0].food_type))]),this._v(" "),e("div",{staticClass:"row"},[e("ul",{staticClass:"list-group"},this._l(this.menu,function(t){return e("MenuItem",{key:t.id,attrs:{item:t}})}))])])},staticRenderFns:[]};var x={name:"Cart",components:{},computed:{cart:function(){return this.$store.getters.getCart}},data:function(){return{errors:[]}},methods:{orderCart:function(t){var e=this;n.a.post("https://pizzeria-order-backend.herokuapp.com/orders",{user:this.$store.getters.getUser,pizzas:this.$store.getters.getCart},{withCredentials:!0}).then(function(t){var s=t.data.order;e.$store.commit("storeOrder",{order:s}),e.$store.commit("clearCart"),e.$router.push("/order")}).catch(function(t){e.errors.push(t)})},clearCart:function(t){this.$store.commit("clearCart")}}},E={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.cart.length?s("div",{staticClass:"bg-danger border",attrs:{id:"cart"}},[t._m(0),t._v(" "),s("div",{attrs:{id:"list"}},[s("ul",{},t._l(t.cart,function(e){return s("li",{},[t._v("\n        "+t._s(e.title)+": "+t._s(e.price)+"kr\n      ")])}))]),t._v(" "),s("div",{attrs:{id:"menu"}},[s("button",{staticClass:"btn btn-success btn-sm",on:{click:t.orderCart}},[t._v("Beställ")]),t._v(" "),s("button",{staticClass:"btn btn-warning btn-sm",on:{click:t.clearCart}},[t._v("Töm inköp")])])]):t._e()},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("nav",{staticClass:"navbar navbar-light bg-light"},[e("span",{staticClass:"navbar-brand mb-0 h1"},[this._v("Pizzakorg")])])}]};var L={name:"Pizzeria",components:{Menu:s("VU/8")($,y,!1,function(t){s("DhLu")},"data-v-21779137",null).exports,Cart:s("VU/8")(x,E,!1,function(t){s("5/3R")},"data-v-02720b92",null).exports},data:function(){return{pizzeria:{},menu:{},errors:[]}},created:function(){var t=this,e=this.$route.params.id;n.a.get("https://pizzeria-order-backend.herokuapp.com/pizzeria/"+e).then(function(e){t.pizzeria=e.data.pizzeria;var s=1;t.menu=e.data.menu.reduce(function(t,e){var r=e.food_type;return e.counter=s++,t[r]=t[r]||[],t[r].push(e),t},{})}).catch(function(e){t.errors.push(e)})}},P={render:function(){var t=this.$createElement,e=this._self._c||t;return e("main",[e("div",{staticClass:"container"},[e("h1",[this._v(this._s(this.pizzeria.name))]),this._v(" "),this._l(this.menu,function(t){return e("Menu",{key:t.id,attrs:{menu:t}})}),this._v(" "),e("hr")],2),this._v(" "),e("Cart")],1)},staticRenderFns:[]};var U=s("VU/8")(L,P,!1,function(t){s("ZFWD")},"data-v-6be81858",null).exports,D={name:"Order",data:function(){return{errors:[]}},computed:{order:function(){return this.$store.getters.getOrder}},methods:{parseDescription:function(t){return t.replace(/\\n/g,"\r\n")},padZero:function(t){return t<10?"0"+t:t},addHour:function(t){var e=new Date(Date.parse(t)+36e5);return console.log(Date.parse(t)),console.log(Date.parse(t)+36e4),this.padZero(e.getHours())+":"+this.padZero(e.getMinutes())},setProgressBarWidth:function(t){document.getElementsByClassName("progress-bar")[0].style.width=t+"%"}},mounted:function(){this.$nextTick(function(){setTimeout(function(t){t.setProgressBarWidth(100)},100,this)})}},F={render:function(){var t=this.$createElement,e=this._self._c||t;return e("main",[e("div",{staticClass:"container"},[e("h2",[this._v("Beställning lagd!")]),this._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:this.order,expression:"order"}]},[this._m(0),this._v(" "),e("p",[this._v("Beställningen innehåller: "+this._s(this.parseDescription(this.order.description))+" till en total kostnad av "+this._s(this.order.amount)+"kr.")]),this._v(" "),e("p",[this._v("Förvänta dig dina pizzor inom klockan "+this._s(this.addHour(this.order.created_at))+".")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"progress"},[e("div",{staticClass:"progress-bar",attrs:{role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"}})])}]};var V=s("VU/8")(D,F,!1,function(t){s("49FQ")},"data-v-48025bfa",null).exports,R={name:"Profile",data:function(){return{errors:[],orders:[]}},computed:{user:function(){return this.$store.getters.getUser}},methods:{totalAmount:function(t){return t||(t=[0]),t.reduce(function(t,e){return t+e.amount},0)},parseDate:function(t){return new Date(Date.parse(t)).toLocaleString()},update:function(t){var e=this,s=t.target,r={email:s.elements[0].value,name:s.elements[1].value,address:s.elements[2].value};s.elements[3].value&&(r.password=s.elements[3].value,r.password_confirmation=s.elements[4].value),n.a.patch("https://pizzeria-order-backend.herokuapp.com/user/"+this.user.id,{user:r},{withCredentials:!0}).then(function(t){document.getElementsByClassName("text-danger")[0].innerHTML="";var s=t.data.user;e.$store.commit("setUser",{user:s})}).catch(function(t){if(t.response){var s="";for(var r in t.response.data.error)s=s+r+" "+t.response.data.error[r]+". ";document.getElementsByClassName("text-danger")[0].innerHTML=h(s)}e.errors.push(t)})}},created:function(){var t=this;n.a.get("https://pizzeria-order-backend.herokuapp.com/orders",{withCredentials:!0}).then(function(e){console.log(e),t.orders=e.data.orders}).catch(function(e){t.errors.push(e)})}},H={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",[t.user?s("div",{staticClass:"container"},[s("h2",[t._v("Uppdatera ditt konto")]),t._v(" "),s("form",{on:{submit:function(e){e.preventDefault(),t.update(e)}}},[s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"email"}},[t._v("E-post")]),t._v(" "),s("div",{staticClass:"col-sm-10"},[s("input",{staticClass:"form-control",attrs:{type:"email",id:"email"},domProps:{value:t.user.email}})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"name"}},[t._v("Namn")]),t._v(" "),s("div",{staticClass:"col-sm-10"},[s("input",{staticClass:"form-control",attrs:{type:"text",id:"name",required:""},domProps:{value:t.user.name}})])]),t._v(" "),s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"address"}},[t._v("Adress")]),t._v(" "),s("div",{staticClass:"col-sm-10"},[s("input",{staticClass:"form-control",attrs:{type:"text",id:"address",required:""},domProps:{value:t.user.address}})])]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),s("div",{staticClass:"col-auto"}),t._v(" "),s("button",{staticClass:"btn btn-primary mb-2",attrs:{type:"submit"}},[t._v("Uppdatera")]),t._v(" "),s("p",{staticClass:"text-danger"})]),t._v(" "),s("h2",[t._v("Du har handlat för totalt: "+t._s(t.totalAmount(t.orders))+"kr")]),t._v(" "),s("p",[t._v("Dina senaste ordrar:")]),t._v(" "),s("div",{staticClass:"list-group"},t._l(t.orders,function(e){return s("div",{staticClass:"list-group-item list-group-item-action flex-column align-items-start"},[s("div",{staticClass:"d-flex w-100 justify-content-between"},[s("h5",{staticClass:"mb-1"},[t._v(t._s(e.number_of_pizzas)+" pizzor till priset av "+t._s(e.amount))]),t._v(" "),s("small",[t._v(t._s(t.parseDate(e.created_at)))])]),t._v(" "),s("p",{staticClass:"mb-1"},[t._v(t._s(e.description))])])}))]):s("div",{staticClass:"container"},[s("h1",[t._v("Logga in för att se din profil")])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"password"}},[this._v("Lösenord")]),this._v(" "),e("div",{staticClass:"col-sm-10"},[e("input",{staticClass:"form-control",attrs:{type:"password",id:"password",placeholder:"•••••••••"}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"password-confirmation"}},[this._v("Lösenordskonfirmation")]),this._v(" "),e("div",{staticClass:"col-sm-10"},[e("input",{staticClass:"form-control",attrs:{type:"password",id:"password-confirmation",placeholder:"•••••••••"}})])])}]};var O=s("VU/8")(R,H,!1,function(t){s("FO3c")},"data-v-358e3652",null).exports;r.a.use(l.a);var q=new l.a({routes:[{path:"/",name:"Index",component:d},{path:"/login",name:"Login",component:v},{path:"/register",name:"Register",component:g},{path:"/pizzerias",name:"Pizzerior",component:w},{path:"/pizzeria/:id",name:"Pizzeria",component:U},{path:"/order",name:"Order",component:V},{path:"/profile",name:"Profile",component:O}]}),M=s("NYxO"),N="pizzeria-vuejs";navigator.userAgent.indexOf("PhantomJS")>-1&&window.localStorage.clear();var T={user:JSON.parse(window.localStorage.getItem(N)||'{"user": {}, "cart": []}')},S=s("mvHQ"),B=s.n(S),j=[function(t){t.subscribe(function(t,e){var s=e.user;window.localStorage.setItem(N,B()(s))})}];r.a.use(M.a);var A=new M.a.Store({state:T,getters:{getUser:function(t){return!!(t.user&&t.user.user&&t.user.user.name)&&t.user.user},getCart:function(t){return!(!t.user||!t.user.cart)&&t.user.cart},getOrder:function(t){return t.user&&t.user.order?t.user.order:{}}},mutations:{setUser:function(t,e){var s=e.user;t.user.user=s},clearSession:function(t){t.user.user={}},addToCart:function(t,e){var s=e.item;t.user.cart||(t.user.cart=[]),t.user.cart.push(s)},clearCart:function(t){t.user.cart=[]},storeOrder:function(t,e){var s=e.order;t.user.order=s}},plugins:j});r.a.config.productionTip=!1,new r.a({store:A,el:"#app",router:q,template:"<App/>",components:{App:c}})},Qajw:function(t,e){},Xm67:function(t,e){},ZFWD:function(t,e){},iu0H:function(t,e){},"uc+P":function(t,e){},wdIp:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.786e1785f9515215424c.js.map